(this["webpackJsonpsnake-ml-experiment"]=this["webpackJsonpsnake-ml-experiment"]||[]).push([[0],{22:function(e,t,n){e.exports=n(35)},23:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);n(23);var a,r,i,o=n(0),c=n.n(o),s=n(15),l=n(4),u=n(1),d=n(3),h=n(17),b=n(18),f=n(19);!function(e){e[e.ready=0]="ready",e[e.running=1]="running",e[e.pause=2]="pause",e[e.gameOver=3]="gameOver"}(a||(a={})),function(e){e.empty="empty",e.wall="wall",e.food="food",e.snake="snake"}(r||(r={})),function(e){e[e.Right=0]="Right",e[e.Down=90]="Down",e[e.Left=180]="Left",e[e.Up=270]="Up"}(i||(i={}));var p=n(5),m=n(6),g=n(7),v=n(9),k=n(8),O=n(10),y=n(20),j=function(){function e(){Object(m.a)(this,e),this.defaultState={cells:[]},this.localState=this.defaultState}return Object(g.a)(e,[{key:"reduceForward",value:function(e){throw new Error("Must be implemented!")}},{key:"reduceBackward",value:function(e){return e}},{key:"reducer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultState,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!n&&t&&(this.localState=this.reduceForward(e)),n||t?Object(y.a)({},e,{},this.localState,{cells:[].concat(Object(p.a)(e.cells),Object(p.a)(this.localState.cells))}):this.reduceBackward(e)}},{key:"random",value:function(e){return Math.floor(Math.random()*e)}},{key:"indexToCoordinate",value:function(e,t){return[Math.trunc(e/t),Math.trunc(e%t)]}},{key:"secondsFromUnixEpoch",value:function(){return Date.now()/1e3}},{key:"randomCoordinate",value:function(e){return[this.random(e),this.random(e)]}},{key:"findCellsByCoord",value:function(e,t){var n=Object(l.a)(t,2),a=n[0],r=n[1];return e.filter((function(e){var t=e.coordinate;e.type;return t[0]===a&&t[1]===r}))}}]),e}(),w=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(v.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(r)))).stepsLeftToDecreaseLength=10,n.stepsForEachFood=10,n}return Object(O.a)(t,e),Object(g.a)(t,[{key:"step",value:function(e){this.collision(e)||this.collisionOthers(e)||this.tastyFood(e)||this.looseLength(e)||this.usualStepForward(e)}},{key:"looseLength",value:function(e){return this.stepsLeftToDecreaseLength--,0===this.stepsLeftToDecreaseLength&&(this.snake.length>=2?(this.stepsLeftToDecreaseLength=this.stepsForEachFood,this.snake=[this.getNextCoord()].concat(Object(p.a)(this.snake.slice(0,this.snake.length-2))),!0):this._died=!0)}},{key:"tastyFood",value:function(e){var t=this.getNextCoord(),n=this.nextCell(e);return(null===n||void 0===n?void 0:n.type)===r.food&&(this.stepsLeftToDecreaseLength=this.stepsForEachFood,this.snake=[t].concat(Object(p.a)(this.snake)),!0)}},{key:"stepsLeft",get:function(){return(this.snake.length-1)*this.stepsForEachFood+this.stepsLeftToDecreaseLength}}]),t}(function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(v.a)(this,Object(k.a)(t).call(this)))._name=void 0,n._died=!1,n.snake=void 0,n.currentDegree=void 0,n.nextDegree=void 0,n.steps=-1,n.tableSize=void 0,n._name=e.name||"Unknown snake",n.snake=e.snake,n.currentDegree=e.direction||0,n.nextDegree=n.currentDegree,n.tableSize=e.tableSize||100,n}return Object(O.a)(t,e),Object(g.a)(t,[{key:"reduceForward",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t||this._died||(this.steps>=0&&this.step(e.cells),this.steps++),{cells:this.snake.map((function(e,t){return{coordinate:e,type:r.snake}}))}}},{key:"step",value:function(e){this.collision(e)||this.collisionOthers(e)||this.tastyFood(e)||this.usualStepForward(e)}},{key:"nextCell",value:function(e){var t=this.getNextCoord(),n=Object(l.a)(t,2),a=n[0],r=n[1];return e.find((function(e){var t=Object(l.a)(e.coordinate,2),n=t[0],i=t[1];return n===a&&i===r}))}},{key:"collision",value:function(e){var t=this.getNextCoord();return!!this.snake.find((function(e){var n=Object(l.a)(e,2),a=n[0],r=n[1];return t[0]===a&&t[1]===r}))&&(this._died=!0)}},{key:"usualStepForward",value:function(e){return this.snake=[this.getNextCoord()].concat(Object(p.a)(this.snake.slice(0,this.snake.length-1))),!0}},{key:"tastyFood",value:function(e){var t;return(null===(t=this.nextCell(e))||void 0===t?void 0:t.type)===r.food&&(this.snake=[this.getNextCoord()].concat(Object(p.a)(this.snake)),!0)}},{key:"collisionOthers",value:function(e){var t=this.nextCell(e);return((null===t||void 0===t?void 0:t.type)===r.snake||(null===t||void 0===t?void 0:t.type)===r.wall)&&(this._died=!0)}},{key:"getNextCoord",value:function(){var e=Object(l.a)(this.snake.slice(0)[0],2),t=e[0],n=e[1],a=180!==Math.abs(this.currentDegree-this.nextDegree);switch(a&&(this.currentDegree=this.nextDegree),a?this.nextDegree:this.currentDegree){case i.Left:return[t,0===n?this.tableSize-1:n-1];case i.Right:return[t,n+1===this.tableSize?0:n+1];case i.Down:return[t+1===this.tableSize?0:t+1,n];case i.Up:return[0===t?this.tableSize-1:t-1,n]}throw new Error("I have no idea how to move this degree o_O: ".concat(this.nextDegree))}},{key:"direction",set:function(e){this.nextDegree=e}},{key:"name",get:function(){return this._name}},{key:"length",get:function(){return this.snake.length}},{key:"died",get:function(){return this._died}},{key:"score",get:function(){return this.steps>0?this.steps:0}}]),t}(j)),x=function(e){function t(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(m.a)(this,t),(n=Object(v.a)(this,Object(k.a)(t).call(this))).lastDinnerTime=void 0,n.tableSize=void 0,n.dinnerRefreshSeconds=7,n.tableSize=e,n.lastDinnerTime=a,n}return Object(O.a)(t,e),Object(g.a)(t,[{key:"reduceForward",value:function(e){return this.secondsFromLastDinner()>this.dinnerRefreshSeconds?(this.dinnerTime(),this.localState={cells:[{coordinate:this.randomCoordinate(this.tableSize),type:r.food}]}):this.localState}},{key:"reduceBackward",value:function(e){return 2===this.findCellsByCoord(e.cells,this.localState.cells[0].coordinate).length&&this.moreFoooood(),e}},{key:"dinnerTime",value:function(){this.lastDinnerTime=(new Date).getTime()/1e3}},{key:"secondsFromLastDinner",value:function(){return this.secondsFromUnixEpoch()-this.lastDinnerTime}},{key:"moreFoooood",value:function(){this.lastDinnerTime=0}},{key:"dinnerEachSeconds",get:function(){return this.dinnerRefreshSeconds}}]),t}(j),S=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;Object(m.a)(this,e),this.defaultState={cells:[]},this.size=void 0,this.fullSize=void 0,this.state=this.defaultState,this.snakes=[],this.food=[],this._cellsForView=[],this.size=t,this.fullSize=t*t,this.reset(),this._cellsForView=this.makeCellsForView()}return Object(g.a)(e,[{key:"reset",value:function(){var e=[Math.trunc(this.size/2),Math.trunc(this.size/2)];this.snakes=[new w({name:"My smart snake",snake:[[e[0],e[1]+1],[e[0],e[1]],[e[0],e[1]-1]],tableSize:this.size})],this.food=[new x(this.size)]}},{key:"tick",value:function(){var e=Array.apply(void 0,Object(p.a)(this.food).concat(Object(p.a)(this.snakes)));return this.state=this.reduce(e,this.reduce(e,this.defaultState),!1),this._cellsForView=this.makeCellsForView(),this._cellsForView}},{key:"reduce",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=n?"reduce":"reduceRight";return e[a]((function(e,t){return t.reducer(e,n)}),t)}},{key:"makeEmptyCellsForView",value:function(){return this._cellsForView=Array(this.fullSize).fill(r.empty)}},{key:"indexToCoordinate",value:function(e,t){return[Math.trunc(e/t),Math.trunc(e%t)]}},{key:"coordinateToIndex",value:function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1];return n*this.size+a}},{key:"makeCellsForView",value:function(){var e=this;if(0===this._cellsForView.length)return this._cellsForView=this.makeEmptyCellsForView();var t=function(e){return Object.keys(r).indexOf(e)},n=this.state.cells.sort((function(n,a){if(e.coordinateToIndex(n.coordinate)<e.coordinateToIndex(a.coordinate))return 1;if(e.coordinateToIndex(n.coordinate)>e.coordinateToIndex(a.coordinate))return-1;if(e.coordinateToIndex(n.coordinate)===e.coordinateToIndex(a.coordinate))return t(n.type)<t(a.type)?1:t(n.type)>t(a.type)?-1:0;throw new Error("Imposible")}));return this._cellsForView=this.makeEmptyCellsForView().map((function(t,a){var i,o=e.indexToCoordinate(a,e.size),c=Object(l.a)(o,2),s=c[0],u=c[1];return(null===(i=n.find((function(e){var t=Object(l.a)(e.coordinate,2),n=t[0];return t[1]===u&&n===s})))||void 0===i?void 0:i.type)||r.empty}))}},{key:"cells",get:function(){return this._cellsForView}},{key:"direction",set:function(e){this.snakes[0].direction=e}},{key:"gameOver",get:function(){return 0===this.snakes.length||this.snakes.filter((function(e){return e.died})).length===this.snakes.length}},{key:"score",get:function(){return this.snakes[0].score}},{key:"stepsLeft",get:function(){return this.snakes[0].stepsLeft}}]),e}())(10),C=function(e){var t=e.cellType;return c.a.createElement("div",{className:t})},E=Object(o.memo)(C);C.whyDidYouRender=!0;var F=function(e){var t=e.classes,n=e.cells;return c.a.createElement("div",{className:"table-css-grid-container ".concat(t.container),style:{gridTemplateColumns:"repeat(".concat(Math.sqrt(n.length),", 1fr)"),gridTemplateRows:"repeat(".concat(Math.sqrt(n.length),", 1fr)")}},n.map((function(e,t){return c.a.createElement(E,{key:t,cellType:e})})))},T=Object(o.memo)(Object(d.a)({container:{width:"100%",height:"100%",border:"2px dashed #F7EEEE",borderRadius:5,display:"grid",gridColumnGap:0,gridRowGap:0}})(F));F.whyDidYouRender=!0;var D,z,N,L,I,M,R=n(21),_=n.n(R),V=Object(d.a)({wrapper:{display:"flex",justifyContent:"center",alignItems:"center",width:"100vw",height:"100vh",margin:"auto"},wrappedMobile:{display:"inherit"},container:{margin:"0 auto"}})((function(e){var t=e.classes,n=e.children,a=e.isMobile;return c.a.createElement("div",{className:_()(t.wrapper,Object(u.a)({},t.wrappedMobile,a))},c.a.createElement("div",{className:t.container},n))})),B={btn:Object(u.a)({display:"inline-block",minWidth:270,margin:"0.4em",padding:"0.7em 3em",fontWeight:400,fontSize:30,backgroundColor:"transparent",border:"4px solid transparent",borderImage:"linear-gradient(to right, #add356 0%, #00dfa6 100%)",borderImageSlice:1,backgroundClip:"border-box",cursor:"pointer"},"textAlign","center"),green:{borderImageSlice:1,borderImage:"linear-gradient(to right, #add356 0%, #00dfa6 100%)"},greenButtonText:{background:"-webkit-linear-gradient(left, #add356, #00dfa6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},orange:{borderImageSlice:1,borderImage:"linear-gradient(to right, #ffcb52 0%, #ff451f 100%)"},orangeButtonText:{background:"-webkit-linear-gradient(left, #ffcb52, #ff451f)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},blue:{borderImageSlice:1,borderImage:"linear-gradient(to right, #3dade9 0%, #bf2fcb 100%)"},blueButtonText:{background:"-webkit-linear-gradient(left, #3dade9, #bf2fcb)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"}},A=Object(d.a)(B)((function(e){var t=e.children,n=e.classes,a=e.color,r=e.onClick,i=Object(o.useCallback)((function(){return r()}),[r]),s="".concat(n.btn," ").concat(n[a]),l=n["".concat(a,"ButtonText")];return c.a.createElement("button",{className:s,onClick:i},c.a.createElement("p",{className:l},t))})),W={container:(D={height:"100%",top:0,left:0,fontSize:"xx-large",backgroundColor:"rgba(0, 0, 0, 0.6)",width:"100%",cursor:"default"},Object(u.a)(D,"textAlign","center"),Object(u.a)(D,"position","fixed"),D),article:{marginTop:"1em"},text:(z={top:"47%",color:"white"},Object(u.a)(z,"position","relative"),Object(u.a)(z,"textAlign","center"),z),title:{fontSize:70,marginBottom:"0.2em"},score:{fontSize:40},description:{marginTop:"1.5em",fontSize:25}},G=Object(d.a)(W)((function(e){var t=e.classes,n=e.score,r=e.state,i=e.start,s=e.reset,l=Object(o.useCallback)((function(){return i()}),[i]),u=Object(o.useCallback)((function(){return s()}),[s]);return c.a.createElement("div",{className:t.container},c.a.createElement(V,null,c.a.createElement("div",{className:"".concat(t.text," ").concat(t.title)},r===a.ready?"Hi there!":null,r===a.pause?"Pause":null,r===a.gameOver?"You los'":null),r===a.pause||r===a.gameOver?c.a.createElement("div",{className:"".concat(t.text," ").concat(t.score)},"Score: ",n):null,c.a.createElement("article",{className:t.article},r===a.ready||r===a.pause?c.a.createElement(A,{onClick:l,color:"green"},r===a.ready?"Start":"Continue"):null,r===a.gameOver||r===a.pause?c.a.createElement(A,{onClick:u,color:r===a.pause?"blue":"orange"},r===a.pause?"New Game":"Try again"):null),c.a.createElement("div",{className:"".concat(t.text," ").concat(t.description)},r===a.ready?' Press the button or "space" to start':null,r===a.pause?' Press "space" to continue or "R" to restart':null,r===a.gameOver?' Press the button or "space" to restart':null)))})),U={paper:(I={"@media (orientation: landscape)":{width:"75vh",height:"75vh"},"@media (orientation: portrait)":{width:"75vw",height:"75vw"},"@media only screen and (max-device-width: 720px)":{width:"100vw",height:"100vw"},backgroundColor:"#fd9170",borderRadius:12},Object(u.a)(I,"position","relative"),Object(u.a)(I,"boxShadow","0 1px 4px rgba(0, 0, 0, 0.3), 0 0 20px rgba(0, 0, 0, 0.1) inset"),Object(u.a)(I,"&::before",(N={},Object(u.a)(N,"position","absolute"),Object(u.a)(N,"content","open-quote"),Object(u.a)(N,"top",100),Object(u.a)(N,"bottom",5),Object(u.a)(N,"left",30),Object(u.a)(N,"right",30),Object(u.a)(N,"zIndex",-1),Object(u.a)(N,"boxShadow","0 0 40px 13px #848484;"),Object(u.a)(N,"borderRadius","100px/20px"),N)),Object(u.a)(I,"&::after",(L={},Object(u.a)(L,"position","absolute"),Object(u.a)(L,"content","open-quote"),Object(u.a)(L,"top",100),Object(u.a)(L,"bottom",5),Object(u.a)(L,"left",30),Object(u.a)(L,"right",30),Object(u.a)(L,"zIndex",-1),Object(u.a)(L,"boxShadow","0 0 40px 13px #848484;"),Object(u.a)(L,"borderRadius","100px/20px"),L)),I),content:{height:"calc(100% - 4px - ".concat(30,"px - ").concat(30,"px)"),width:"calc(100% - 4px - ".concat(30,"px - ").concat(30,"px)"),margin:"".concat(30,"px"),display:"inline-block"}},H=Object(d.a)(U)((function(e){var t=e.classes,n=e.children;return c.a.createElement("div",{className:t.paper},c.a.createElement("div",{className:t.content},n))})),P={container:{display:"flex",marginTop:5,justifyContent:"space-evenly",width:"100%"},text:(M={padding:6,font:"900 25px/1 'Source Sans Pro', Arial, sans-serif"},Object(u.a)(M,"textTransform","uppercase"),Object(u.a)(M,"color","#fff"),Object(u.a)(M,"backgroundColor","#fb8f6e"),M),menu:{backgroundColor:"rgb(251, 143, 110)",zoom:1,fill:"white",height:37,width:37,"&:hover":{backgroundColor:"rgb(253, 174, 150)"}}},K=Object(d.a)(P)((function(e){var t=e.classes,n=e.score,a=e.stepsLeft,r=e.pause,i=Object(o.useCallback)((function(){return r()}),[r]);return c.a.createElement("div",{className:t.container,onClick:i},c.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:t.menu,height:"24",viewBox:"0 0 24 24",width:"24"},c.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),c.a.createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"})),c.a.createElement("p",{className:t.text},"Score: ",n>=0?n:0),c.a.createElement("p",{className:t.text},"Steps left: ",a))})),q={container:Object(u.a)({margin:5,bottom:0},"position","fixed"),link:{textShadow:"1px 1px 1px #656363",textDecoration:"inherit",color:"white"}},Y=Object(d.a)(q)((function(e){var t=e.classes;return c.a.createElement("div",{className:t.container},c.a.createElement("a",{className:t.link,href:"https://github.com/specialistvlad/snake-mini-game-web",rel:"noopener noreferrer",target:"_blank"},"Project on GitHub"))})),J=0,Q={container:Object(u.a)({height:"100%","@media (orientation: landscape)":{width:"75vh"},"@media (orientation: portrait)":{width:"75vw"},"@media only screen and (max-device-width: 720px)":{width:"100vw"},display:"flex",justifyContent:"center",alignItems:"center",margin:"auto"},"flexDirection","column"),spacer:{height:25}},X=Object(d.a)(Q)((function(e){var t=e.classes,n=Object(o.useState)(a.ready),r=Object(l.a)(n,2),i=r[0],s=r[1],u=Object(o.useState)(S.cells),d=Object(l.a)(u,2),p=d[0],m=d[1],g=Object(o.useState)(S.score),v=Object(l.a)(g,2),k=v[0],O=v[1],y=Object(o.useState)(S.stepsLeft),j=Object(l.a)(y,2),w=j[0],x=j[1],C=Object(o.useCallback)((function(e){switch((null===e||void 0===e?void 0:e.dir)||(null===e||void 0===e?void 0:e.code)){case"Right":case"ArrowRight":case"KeyD":S.direction=0;break;case"Down":case"ArrowDown":case"KeyS":S.direction=90;break;case"Left":case"ArrowLeft":case"KeyA":S.direction=180;break;case"Up":case"ArrowUp":case"KeyW":S.direction=270;break;case"Space":case"Escape":case"Enter":case"Menu":case"StartGame":S.gameOver&&S.reset(),i===a.running?s(a.pause):s(a.running);break;case"KeyR":case"ResetGame":S.reset(),s(a.running)}}),[i]);Object(h.a)("keydown",C);var E=Object(b.a)({onSwiped:C,preventDefaultTouchmoveEvent:!0,trackMouse:!0});Object(o.useEffect)((function(){var e=setInterval((function(){J<1e3&&i===a.running&&(J++,m(S.tick())),S.gameOver&&s(a.gameOver),O(S.score),x(S.stepsLeft)}),f.isMobile?350:250);return function(){return clearTimeout(e)}}),[i]);var F=Object(o.useCallback)((function(){return C({code:"StartGame"})}),[C]),D=Object(o.useCallback)((function(){return C({code:"ResetGame"})}),[C]),z=Object(o.useCallback)((function(){return C({code:"Menu"})}),[C]);return c.a.createElement("div",Object.assign({className:t.container},E),c.a.createElement(K,{score:k,stepsLeft:w,pause:z}),c.a.createElement("div",{className:t.spacer}),c.a.createElement(H,null,c.a.createElement(T,{cells:p})),i===a.running?null:c.a.createElement(G,{state:i,score:k,start:F,reset:D}),c.a.createElement(Y,null))}));Object(s.render)(c.a.createElement(X,null),document.getElementById("root"))}},[[22,1,2]]]);
//# sourceMappingURL=main.c208b212.chunk.js.map